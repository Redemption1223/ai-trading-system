{% extends "base.html" %}

{% block title %}Chart View - AGI Trading System{% endblock %}

{% block content %}
<div class="chart-view-container">
    <div class="chart-toolbar">
        <div class="toolbar-section">
            <label>Symbol:</label>
            <select id="chart-symbol" class="symbol-selector">
                <option value="EURUSD">EUR/USD</option>
                <option value="GBPUSD">GBP/USD</option>
                <option value="USDJPY">USD/JPY</option>
                <option value="AUDUSD">AUD/USD</option>
                <option value="USDCAD">USD/CAD</option>
                <option value="USDCHF">USD/CHF</option>
                <option value="NZDUSD">NZD/USD</option>
            </select>
        </div>
        
        <div class="toolbar-section">
            <label>Timeframe:</label>
            <div class="timeframe-buttons">
                <button class="timeframe-btn" data-timeframe="M1">M1</button>
                <button class="timeframe-btn" data-timeframe="M5">M5</button>
                <button class="timeframe-btn" data-timeframe="M15">M15</button>
                <button class="timeframe-btn active" data-timeframe="H1">H1</button>
                <button class="timeframe-btn" data-timeframe="H4">H4</button>
                <button class="timeframe-btn" data-timeframe="D1">D1</button>
            </div>
        </div>
        
        <div class="toolbar-section">
            <label>Indicators:</label>
            <div class="indicator-toggles">
                <label class="indicator-toggle">
                    <input type="checkbox" data-indicator="sma"> SMA
                </label>
                <label class="indicator-toggle">
                    <input type="checkbox" data-indicator="ema"> EMA
                </label>
                <label class="indicator-toggle">
                    <input type="checkbox" data-indicator="rsi"> RSI
                </label>
                <label class="indicator-toggle">
                    <input type="checkbox" data-indicator="macd"> MACD
                </label>
            </div>
        </div>
    </div>
    
    <div class="chart-main">
        <div class="price-info">
            <div class="current-price">
                <span class="symbol-name" id="current-symbol">EUR/USD</span>
                <span class="price-value" id="current-price">1.08450</span>
                <span class="price-change" id="price-change">+0.00025 (+0.02%)</span>
            </div>
            <div class="price-details">
                <span>Spread: <span id="spread">0.8</span></span>
                <span>|</span>
                <span>Volume: <span id="volume">--</span></span>
                <span>|</span>
                <span>Time: <span id="chart-time">--:--:--</span></span>
            </div>
        </div>
        
        <div id="main-chart" class="main-chart-container">
            <div class="chart-placeholder">
                <div class="placeholder-content">
                    <h2>üìä Advanced Chart View</h2>
                    <p>Professional trading charts with technical indicators</p>
                    <p><strong>Status:</strong> Template Ready</p>
                    <p><strong>Implementation:</strong> Phase 2</p>
                    <div class="placeholder-features">
                        <h4>Planned Features:</h4>
                        <ul>
                            <li>Real-time candlestick charts</li>
                            <li>Technical indicators overlay</li>
                            <li>Signal markers and annotations</li>
                            <li>Multi-timeframe analysis</li>
                            <li>Interactive drawing tools</li>
                            <li>Volume analysis</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="indicator-panels">
            <div id="rsi-panel" class="indicator-panel" style="display: none;">
                <div class="panel-header">RSI (14)</div>
                <div class="indicator-chart">RSI Chart Placeholder</div>
            </div>
            
            <div id="macd-panel" class="indicator-panel" style="display: none;">
                <div class="panel-header">MACD (12,26,9)</div>
                <div class="indicator-chart">MACD Chart Placeholder</div>
            </div>
        </div>
    </div>
    
    <div class="chart-sidebar">
        <div class="sidebar-panel">
            <h4>üéØ AI Signals</h4>
            <div id="chart-signals" class="signals-container">
                <div class="signal-marker signal-buy">
                    <div class="signal-time">Template</div>
                    <div class="signal-info">
                        <strong>BUY Signal</strong><br>
                        Confidence: Ready<br>
                        Source: Phase 2
                    </div>
                </div>
            </div>
        </div>
        
        <div class="sidebar-panel">
            <h4>üìà Market Info</h4>
            <div class="market-info">
                <div class="info-row">
                    <span>Open:</span>
                    <span id="day-open">--</span>
                </div>
                <div class="info-row">
                    <span>High:</span>
                    <span id="day-high">--</span>
                </div>
                <div class="info-row">
                    <span>Low:</span>
                    <span id="day-low">--</span>
                </div>
                <div class="info-row">
                    <span>Close:</span>
                    <span id="day-close">--</span>
                </div>
            </div>
        </div>
        
        <div class="sidebar-panel">
            <h4>‚öôÔ∏è Chart Settings</h4>
            <div class="chart-settings">
                <label>
                    <input type="checkbox" id="show-grid" checked> Show Grid
                </label>
                <label>
                    <input type="checkbox" id="show-volume" checked> Show Volume
                </label>
                <label>
                    <input type="checkbox" id="auto-scale" checked> Auto Scale
                </label>
                <label>
                    Chart Style:
                    <select id="chart-style">
                        <option value="candlestick">Candlestick</option>
                        <option value="ohlc">OHLC Bars</option>
                        <option value="line">Line</option>
                    </select>
                </label>
            </div>
        </div>
    </div>
</div>

<style>
.chart-view-container {
    display: flex;
    flex-direction: column;
    height: calc(100vh - 80px);
    padding: 10px;
}

.chart-toolbar {
    display: flex;
    gap: 20px;
    align-items: center;
    padding: 15px;
    background-color: var(--bg-secondary);
    border-radius: 8px;
    margin-bottom: 10px;
}

.toolbar-section {
    display: flex;
    align-items: center;
    gap: 10px;
}

.toolbar-section label {
    font-size: 12px;
    color: var(--text-secondary);
}

.indicator-toggles {
    display: flex;
    gap: 15px;
}

.indicator-toggle {
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.chart-main {
    display: flex;
    flex-direction: column;
    flex: 1;
    background-color: var(--bg-secondary);
    border-radius: 8px;
    padding: 15px;
    margin-right: 10px;
}

.price-info {
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 15px;
    margin-bottom: 15px;
}

.current-price {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 10px;
}

.symbol-name {
    font-size: 18px;
    font-weight: bold;
}

.price-value {
    font-size: 24px;
    font-weight: bold;
    color: var(--accent-green);
}

.price-details {
    display: flex;
    gap: 10px;
    font-size: 12px;
    color: var(--text-secondary);
}

.main-chart-container {
    flex: 1;
    min-height: 400px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    position: relative;
}

.chart-placeholder {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    text-align: center;
}

.placeholder-content {
    max-width: 500px;
}

.placeholder-features {
    margin-top: 20px;
    text-align: left;
    background-color: rgba(64, 64, 64, 0.3);
    padding: 15px;
    border-radius: 8px;
}

.placeholder-features ul {
    margin: 10px 0;
    padding-left: 20px;
}

.chart-view-container {
    display: flex;
    flex-direction: row;
}

.chart-sidebar {
    width: 250px;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.sidebar-panel {
    background-color: var(--bg-secondary);
    border-radius: 8px;
    padding: 15px;
}

.sidebar-panel h4 {
    margin: 0 0 15px 0;
    border-bottom: 1px solid var(--border-color);
    padding-bottom: 10px;
}

.signals-container {
    max-height: 200px;
    overflow-y: auto;
}

.signal-marker {
    padding: 10px;
    margin: 5px 0;
    border-radius: 4px;
    border-left: 4px solid;
}

.signal-buy { border-left-color: var(--accent-green); }

.market-info .info-row {
    display: flex;
    justify-content: space-between;
    margin: 5px 0;
    font-size: 12px;
}

.chart-settings {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.chart-settings label {
    font-size: 12px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.chart-settings select {
    margin-top: 5px;
    background-color: var(--bg-primary);
    color: var(--text-primary);
    border: 1px solid var(--border-color);
    border-radius: 4px;
    padding: 3px;
}
</style>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/chart_controls.js') }}"></script>
<script>
// Chart view specific functionality
document.addEventListener('DOMContentLoaded', function() {
    // Update time display
    function updateTime() {
        document.getElementById('chart-time').textContent = new Date().toLocaleTimeString();
    }
    setInterval(updateTime, 1000);
    updateTime();
});
</script>
{% endblock %}